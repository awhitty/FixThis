{"ts":1353999331271,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"{% load staticfiles %}\n<!DOCTYPE html> \n<html> \n<head> \n\t<title>FixThis</title> \n\n\t<meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n \t<meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\">\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"> \n\n\t<link rel=\"stylesheet\" href=\"http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css\" />\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"css/master.css\" %}\">\n\n\t<!-- libraries -->\n\t<script src=\"//cdn.optimizely.com/js/141765726.js\"></script>\n\t<script src=\"http://code.jquery.com/jquery-1.8.2.min.js\"></script>\n\t<script src=\"http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.js\"></script>\n\t<script src=\"http://malsup.github.com/jquery.form.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://maps.google.com/maps/api/js?sensor=true\"></script>\n\t<script type=\"text/javascript\" src=\"https://raw.github.com/HPNeo/gmaps/master/gmaps.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://raw.github.com/carhartl/jquery-cookie/master/jquery.cookie.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://raw.github.com/bradbirdsall/Swipe/master/swipe.min.js\"></script>\n\t{# <script src=\"http://documentcloud.github.com/underscore/underscore.js\"></script> #}\n\t{# <script src=\"http://backbonejs.org/backbone.js\"></script> #}\n\n\t<!-- app -->\n\n\t<script type=\"text/javascript\">\n\t\tvar latitude, longitude;\n\n\t\t$(window).on('pageinit', function() {\n\t\t\tif(!($.cookie('userLat')&&$.cookie('userLon'))) {\n\t\t\t\tupdateLocation();\n\t\t\t}\n\n\t\t\tvar nowDate, cookieDate;\n\t\t\tnowDate = new Date();\n\t\t\tif ($.cookie('locDate')) {\n\t\t\t\tcookieDate = new Date($.cookie('locDate'));\n\t\t\t}\n\n\t\t\tif (!cookieDate || nowDate - cookieDate > 1000000) {\n\t\t\t\t$.cookie('locDate', nowDate.toUTCString());\n\t\t\t\tupdateLocation();\n\t\t\t\t// alert('updating location')\n\t\t\t}\n\n\n\t\t}) \n\t\tfunction updateLocation() {\n\t\t\tGMaps.geolocate({\n\t\t\t\tsuccess: function(position) {\n\t\t\t\t\t$.removeCookie('userLat');\n\t\t\t\t\t$.removeCookie('userLon');\n\n  \t\t\t  \t\t$.cookie('userLat', position.coords.latitude)\n  \t\t\t  \t\t$.cookie('userLon', position.coords.longitude)\n\n  \t\t\t  \t\tlatitude = position.coords.latitude;\n  \t\t\t  \t\tlongitude = position.coords.longitude;\n  \t\t\t  \t\tconsole.log(\"Finished locating user and set a cookie\")\n  \t\t\t\t},\n\t\t\t})\n\t\t}\n\t</script>\n</head> \n<body>\n\t<div id=\"{% block id %}{% endblock id %}\" data-role=\"page\" data-url=\"{{ request.get_full_path }}\">\n\t\t{% if messages %}\n\t\t\t<ul class=\"messages\">\n    \t\t{% for message in messages %}\n    \t\t\t<li{% if message.tags %} class=\"{{ message.tags }}\"{% endif %}>{{ message }}</li>\n    \t\t{% endfor %}\n\t\t\t</ul>\n\t\t{% endif %}\n\t\t{% block content %}{% endblock content %}\n\t</div>\n\n\t<script type=\"text/javascript\">\n\t\t\t// The following code is from https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#ajax\n\t\t\tvar csrftoken = $.cookie('csrftoken');\n\n\t\t\tfunction csrfSafeMethod(method) {\n\t\t\t    // these HTTP methods do not require CSRF protection\n\t\t\t    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));\n\t\t\t}\n\t\t\t$.ajaxSetup({\n\t\t\t    crossDomain: false, // obviates need for sameOrigin test\n\t\t\t    beforeSend: function(xhr, settings) {\n\t\t\t        if (!csrfSafeMethod(settings.type)) {\n\t\t\t            xhr.setRequestHeader(\"X-CSRFToken\", csrftoken);\n\t\t\t        }\n\t\t\t    }\n\t\t\t});\n\t</script>\n</body>\n</html>\n"]],"start1":0,"start2":0,"length1":0,"length2":3297}]],"length":3297}
