{"ts":1353996975032,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"{% extends \"base.html\" %}\n{% block id %}submit{% endblock id %}\n{% block content %}\n\t<div class=\"toolbar\" data-role=\"header\" data-position=\"fixed\" data-theme=\"b\">\n\t\t<h1>Submit</h1>\n\t\t<a href=\"/\" data-direction=\"reverse\" data-transition=\"pop\">Cancel</a>\n\t</div>\n\n\t<div data-role=\"content\">\n\t\t<div class=\"submit-form\" data-role=\"fieldcontain\">\n\t\t\t{# TODO: Make markup prettier (remove BRs) #}\n\t\t\t<div href=\"#\" id=\"upload_override\" class=\"add_image\">\n\t\t\t\t<i class=\"icon-camera\"></i>\n\t\t\t\t<h2>Tap to add photo</h2>\n\t\t\t</div>\n\t\t\t<form id=\"submit-form\" enctype=\"multipart/form-data\" action=\"{% url add-request %}\" method=\"POST\" data-ajax=\"false\">\n\t\t\t\t{% csrf_token %}\n\t\t\t\t{% for field in form %}\n        \t\t\t<div class=\"fieldWrapper {% if field.errors %}errors{% endif %}\" data-role=\"fieldcontain\">\n        \t\t\t\t{# {% if field.label = \"Latitude\" %} #}\n        \t\t\t\t{# <div class=\"map\"></div> #}\n        \t\t\t\t{# <fieldset id=\"fake_location\" data-role=\"controlgroup\"> #}\n        \t\t\t\t\t{# <legend>Location</legend> #}\n        \t\t\t\t\t{# <input type=\"radio\" name=\"radio-choice\" id=\"radio-choice-1\" value=\"cur\" checked=\"checked\" /> #}\n     \t\t\t\t\t\t{# <label for=\"radio-choice-1\" style=\"color: #049cdb;\">Current location</label> #}\n\t\t\t\t\t\n     \t\t\t\t\t\t{# <input type=\"radio\" name=\"radio-choice\" id=\"radio-choice-2\" value=\"choice-2\"  /> #}\n     \t\t\t\t\t\t{# <label for=\"radio-choice-2\">Custom address</label> #}\n     \t\t\t\t\t{# </fieldset> #}\n        \t\t\t\t{# {% endif %} #}\n        \t\t\t    {{ field.errors }}\n        \t\t\t    {{ field.label_tag }} {{ field }}\n        \t\t\t</div>\n    \t\t\t{% endfor %}\n\t\t\t\t<input id=\"submit-button\" type=\"submit\" value=\"Submit\" data-theme=\"b\" />\n\t\t\t</form>\n\t\t</div>\n\t</div>\n\t{# <div data-role=\"popup\" id=\"popupLocation\" data-theme=\"a\"> #}\n\t\t\t{# <form> #}\n\t\t\t\t{# <div style=\"padding:10px 20px;\"> #}\n\t\t\t\t  {# <input type=\"text\" id=\"custom_address\" /> #}\n\t\t\t\t{# </div> #}\n\t\t\t{# </form> #}\n\t\t{# </div> #}\n\n\t{# <div data-role=\"footer\" data-position=\"fixed\" class=\"\"> #}\n\t\t{# <div data-role=\"navbar\"> #}\n\t\t\t{# <ul> #}\n\t\t\t\t{# <li><a href=\"#\" data-rel=\"back\" data-theme=\"c\"><i class=\"icon-remove\"></i> Cancel</a></li> #}\n\t\t\t\t{# <li><a href=\"#\" data-theme=\"b\"><i class=\"icon-plus\"></i> Submit</a></li> #}\n\t\t\t{# </ul> #}\n\t\t{# </div> #}\n\t{# </div> #}\n\t<script type=\"text/javascript\">\n\t\t//Hide latitude and longitude\n\t\t$('#id_latitude, label[for=\"id_latitude\"]').hide()\n\t\t$('#id_longitude').parent().hide()\n\t\t// $('#id_image').parent().hide()\n\n\t\t$('#fake_location').on('change', function() {\n\t\t\tif ($(this).val() == 'cur') {\n\t\t\t\tif($.cookie('userLat')) {$('#id_latitude').val($.cookie('userLat'))}  \n\t\t\t\tif($.cookie('userLon')) {$('#id_longitude').val($.cookie('userLon'))} \n\t\t\t} else {\n\t\t\t\t$( \"#popupLocation\" ).popup(\"open\")\n\t\t\t}\n\t\t})\n\n\t\t$('#id_description').attr('placeholder', 'Description')\n\n\t\t// This snippet allows us to pull up the image selector when a user taps the \"Tap to add image\" icon\n\t\t$('#upload_override').click(function(e) { $('#id_image').click() })\n\n\t\tif($.cookie('userLat')) {$('#id_latitude').val($.cookie('userLat'))}  \n\t\tif($.cookie('userLon')) {$('#id_longitude').val($.cookie('userLon'))}  \n\n\t\t$(\"#submit\").on('pagebeforeshow', function(event, data) {\n\t\t\tvar prev_url = data.prevPage.attr('data-url')\n   \t\t\tconsole.log(\"the previous page was: \" + prev_url);\n   \t\t\t//problem: activates if statement even when prev_url is undefined?\n   \t\t\tif (prev_url) {\n   \t\t\t\t$('#submit-form').attr('action', $('#submit-form').attr('action') + \"?next=\" + prev_url)\n   \t\t\t}\n   \t\t\tupdateLocation()\n\t\t});\n\n\t\t$('#id_image').on('change', function () {\n\t\t\tvar file = this.files[0];\n\t\t\t// $('#upload_override').append(\"<img />\")\n\t\t\tvar image = $('#upload_override')\n\t\t\treader = new FileReader();\n\t\t\treader.onload = function (e) {\n\t\t\t\timage.css('background-image', 'url('+e.target.result+')')\n\t\t\t\timage.css('background-size', 'cover')\n\t\t\t\t$('#upload_override h2, #upload_override i').hide()\n\t\t\t\t$('#upload_override').height('250px')\n\t\t\t}\n\t\t\treader.readAsDataURL(file);\n\t\t})\n\t\t// $('#submit-button').click(function(e) {\n\t\t// \t$('#submit-form').ajaxSubmit(function(d) {\n\t\t// \t\talert($('#submit-form', d).html())\n\t\t// \t\t$(this).html()\n\t\t// \t})\n\t\t// })\n\t</script>\n{% endblock content %}"]],"start1":0,"start2":0,"length1":0,"length2":4164}]],"length":4164}
