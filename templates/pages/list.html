{% extends "base.html" %}
{% load thumbnail places %}
{% block content %}
	<div class="toolbar" data-role="header" data-position="fixed" data-theme="b">
		<h1>List</h1>
		<a href="/" data-transition="pop"><i class="icon-th"></i></a>
	</div>

	<div data-role="content">

		<!-- TODO: Add iScroll/pull-to-refresh support for listview -->
		<ul data-role="listview">
			<li data-role="list-divider">Fixes within 2 miles of your location</li>
			{% for req in requests %}
			{# {{ req.status }} This tag returns the request's status as a number 0-2 #} 
			{# {{ req.get_status_display }} This tag returns the request's status as a string "Open", "Taken", etc.. #}
				<li>
					<a href="{% url detail-request req.id %}" class="ui-link-inherit" data-transition="slide">
						<img src="{{ req.image.url }}" class="ui-li-thumb">
						<h3 class="ui-li-heading">{{ req.description|truncatewords:5 }}</h3>
						<p class="muted ui-li-desc">{% distance_to latitude longitude req.latitude req.longitude %}</p>
						<label class="muted ui-li-heading">
						{% if req.status == 0 %} OPEN 
							{% else %} 
								{% if req.status == 1 %} TAKEN
									{% else %}
										{% if req.status == 2 %} DONE
											{% else %} NA
										{% endif %}							 
								{% endif %}
						{% endif %}	
						</label>
					</a>
				</li>
			{% endfor %}
		</ul>
	</div>

	{% include "includes/list-map-footer.html" %}
{% endblock content %}